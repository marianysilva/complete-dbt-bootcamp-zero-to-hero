{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.5", "generated_at": "2024-01-26T14:03:31.373729Z", "invocation_id": "1b1cf147-d720-4311-be11-43be38e7ba26", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.294244Z", "completed_at": "2024-01-26T14:03:27.295587Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:27.296171Z", "completed_at": "2024-01-26T14:03:27.296176Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0032072067260742188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "seed.dbtlearn.seed_full_moon_dates", "compiled": null, "compiled_code": null, "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.298001Z", "completed_at": "2024-01-26T14:03:27.300231Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:27.300777Z", "completed_at": "2024-01-26T14:03:27.300783Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003923177719116211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbtlearn.scd_raw_hosts", "compiled": true, "compiled_code": "\n\n\nSELECT * FROM AIRBNB.raw.raw_hosts\n", "relation_name": "AIRBNB.DEV.scd_raw_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.302448Z", "completed_at": "2024-01-26T14:03:27.304610Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:27.305131Z", "completed_at": "2024-01-26T14:03:27.305135Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00373077392578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbtlearn.scd_raw_listings", "compiled": true, "compiled_code": "\n\n\nSELECT * FROM AIRBNB.raw.raw_listings\n", "relation_name": "AIRBNB.DEV.scd_raw_listings"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.306877Z", "completed_at": "2024-01-26T14:03:27.316195Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:27.316695Z", "completed_at": "2024-01-26T14:03:27.316698Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011001110076904297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.dbt_expectations_source_expect_column_distinct_count_to_equal_airbnb_listings_room_type__4.1e56c20a65", "compiled": true, "compiled_code": "\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \ncount(distinct room_type) = 4\n as expression\n\n\n    from AIRBNB.raw.raw_listings\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.318319Z", "completed_at": "2024-01-26T14:03:27.325719Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:27.326165Z", "completed_at": "2024-01-26T14:03:27.326169Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008839845657348633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.dbt_expectations_source_expect_column_values_to_match_regex_airbnb_listings_price___0_9_.0b0ac4c79b", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n\n\n    \nregexp_instr(price, '^\\\\$[0-9\\\\.]+$', 1, 1, 0, '')\n\n\n > 0\n as expression\n\n\n    from AIRBNB.raw.raw_listings\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.327618Z", "completed_at": "2024-01-26T14:03:27.331061Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:27.331452Z", "completed_at": "2024-01-26T14:03:27.331455Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004752159118652344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.dim_hosts_cleansed", "compiled": true, "compiled_code": "\n\nWITH  __dbt__cte__src_hosts as (\nWITH raw_hosts AS (\n    SELECT\n        *\n    FROM\n        AIRBNB.raw.raw_hosts\n)\n\nSELECT\n    id AS host_id,\n\n    is_superhost,\n    NAME AS host_name,\n\n    created_at,\n    updated_at\nFROM\n    raw_hosts\n), src_hosts AS (\n    SELECT * FROM __dbt__cte__src_hosts\n)\n\nSELECT\n    host_id,\n\n    IFF(is_superhost = 't', TRUE, FALSE) AS is_superhost,\n    IFNULL(host_name, 'Anonymous') AS host_name,\n\n    created_at,\n    updated_at\nFROM\n    src_hosts", "relation_name": "AIRBNB.DEV.dim_hosts_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.332828Z", "completed_at": "2024-01-26T14:03:27.336234Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:27.336616Z", "completed_at": "2024-01-26T14:03:27.336619Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004635334014892578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.dim_listings_cleansed", "compiled": true, "compiled_code": "\n\nWITH  __dbt__cte__src_listings as (\nWITH raw_listings AS (\n    SELECT\n        *\n    FROM\n        AIRBNB.raw.raw_listings\n)\n\nSELECT\n    id AS listing_id,\n    host_id,\n\n    name AS listing_name,\n    listing_url,\n    room_type,\n    minimum_nights,\n    price AS price_str,\n\n    created_at,\n    updated_at\nFROM\n    raw_listings\n), src_listings AS (\n    SELECT * FROM __dbt__cte__src_listings\n)\n\nSELECT\n    listing_id,\n    host_id,\n\n    listing_name,\n    room_type,\n    IFF(minimum_nights = 0, 1, minimum_nights) AS minimum_nights,\n    REPLACE(price_str, '$')::NUMBER(10, 2) AS price,\n\n    created_at,\n    updated_at\nFROM\n    src_listings", "relation_name": "AIRBNB.DEV.dim_listings_cleansed"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.338003Z", "completed_at": "2024-01-26T14:03:27.350333Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:27.350726Z", "completed_at": "2024-01-26T14:03:27.350729Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0135498046875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.fct_reviews", "compiled": true, "compiled_code": "\n\nWITH  __dbt__cte__src_reviews as (\nWITH raw_reviews AS (\n    SELECT\n        *\n    FROM\n        AIRBNB.raw.raw_reviews\n)\n\nSELECT\n    listing_id,\n\n    date AS review_date,\n    reviewer_name,\n    comments AS review_text,\n    sentiment AS review_sentiment\nFROM\n    raw_reviews\n), src_reviews AS (\n    SELECT * FROM __dbt__cte__src_reviews\n)\n\nSELECT\n    md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) AS review_id,\n    *\nFROM\n    src_reviews\nWHERE\n    review_text IS NOT NULL\n\n    \n        AND review_date > (SELECT MAX(review_date) FROM AIRBNB.DEV.fct_reviews)\n    ", "relation_name": "AIRBNB.DEV.fct_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.351993Z", "completed_at": "2024-01-26T14:03:27.356236Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:27.356634Z", "completed_at": "2024-01-26T14:03:27.356636Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005460023880004883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.accepted_values_dim_hosts_cleansed_is_superhost__t__f.d6051554e4", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        is_superhost as value_field,\n        count(*) as n_records\n\n    from AIRBNB.DEV.dim_hosts_cleansed\n    group by is_superhost\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    't','f'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.357895Z", "completed_at": "2024-01-26T14:03:27.361947Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:27.362342Z", "completed_at": "2024-01-26T14:03:27.362344Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005270957946777344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_hosts_cleansed_created_at.6fda63d103", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom AIRBNB.DEV.dim_hosts_cleansed\nwhere created_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.363687Z", "completed_at": "2024-01-26T14:03:27.366778Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:27.367160Z", "completed_at": "2024-01-26T14:03:27.367162Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004339933395385742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_hosts_cleansed_host_id.de84c3da05", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect host_id\nfrom AIRBNB.DEV.dim_hosts_cleansed\nwhere host_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.368422Z", "completed_at": "2024-01-26T14:03:27.370595Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:27.370989Z", "completed_at": "2024-01-26T14:03:27.370991Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0033721923828125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_hosts_cleansed_host_name.42386c5830", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect host_name\nfrom AIRBNB.DEV.dim_hosts_cleansed\nwhere host_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.372334Z", "completed_at": "2024-01-26T14:03:27.374489Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:27.374892Z", "completed_at": "2024-01-26T14:03:27.374894Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0035147666931152344, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_hosts_cleansed_updated_at.ef28c55b00", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom AIRBNB.DEV.dim_hosts_cleansed\nwhere updated_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.376174Z", "completed_at": "2024-01-26T14:03:27.379459Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:27.379848Z", "completed_at": "2024-01-26T14:03:27.379851Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004483938217163086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.unique_dim_hosts_cleansed_host_id.d7e4771347", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    host_id as unique_field,\n    count(*) as n_records\n\nfrom AIRBNB.DEV.dim_hosts_cleansed\nwhere host_id is not null\ngroup by host_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.381083Z", "completed_at": "2024-01-26T14:03:27.382781Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:27.383153Z", "completed_at": "2024-01-26T14:03:27.383155Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.002863168716430664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.dim_listings_w_hosts", "compiled": true, "compiled_code": "WITH listings AS (\n    SELECT * FROM AIRBNB.DEV.dim_listings_cleansed\n),\nhosts AS (\n    SELECT * FROM AIRBNB.DEV.dim_hosts_cleansed\n)\n\nSELECT\n    listings.listing_id,\n    listings.host_id,\n\n    listings.listing_name,\n    listings.room_type,\n    listings.minimum_nights,\n    listings.price,\n\n    hosts.host_name,\n    hosts.is_superhost AS host_is_superhost,\n\n    listings.created_at,\n    GREATEST(listings.updated_at, hosts.updated_at) AS updated_at\nFROM\n    listings\n    LEFT JOIN hosts ON listings.host_id = hosts.host_id", "relation_name": "AIRBNB.DEV.dim_listings_w_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.384478Z", "completed_at": "2024-01-26T14:03:27.387727Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:27.388134Z", "completed_at": "2024-01-26T14:03:27.388136Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004503965377807617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.accepted_values_dim_listings_cleansed_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.a95127e3af", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        room_type as value_field,\n        count(*) as n_records\n\n    from AIRBNB.DEV.dim_listings_cleansed\n    group by room_type\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Entire home/apt','Private room','Shared room','Hotel room'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.389387Z", "completed_at": "2024-01-26T14:03:27.391008Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:27.391371Z", "completed_at": "2024-01-26T14:03:27.391373Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0027730464935302734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.dim_listings_minumum_nights", "compiled": true, "compiled_code": "SELECT\n    *\nFROM\n    AIRBNB.DEV.dim_listings_cleansed\nWHERE\n    minimum_nights < 1\nLIMIT 10", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:27.392567Z", "completed_at": "2024-01-26T14:03:28.474752Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.475456Z", "completed_at": "2024-01-26T14:03:28.475462Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.4601659774780273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.no_nulls_in_dim_listings", "compiled": true, "compiled_code": "\n    SELECT\n        *\n    FROM\n        AIRBNB.DEV.dim_listings_cleansed\n    WHERE\n        LISTING_ID IS NULL OR\n        HOST_ID IS NULL OR\n        LISTING_NAME IS NULL OR\n        ROOM_TYPE IS NULL OR\n        MINIMUM_NIGHTS IS NULL OR\n        PRICE IS NULL OR\n        CREATED_AT IS NULL OR\n        UPDATED_AT IS NULL OR\n        \n        FALSE\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.856892Z", "completed_at": "2024-01-26T14:03:28.863848Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.864727Z", "completed_at": "2024-01-26T14:03:28.864740Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010129213333129883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_listings_cleansed_created_at.69f5a580a6", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect created_at\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere created_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.867554Z", "completed_at": "2024-01-26T14:03:28.872124Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.872832Z", "completed_at": "2024-01-26T14:03:28.872837Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0070247650146484375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_listings_cleansed_host_id.084e4105be", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect host_id\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere host_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.874955Z", "completed_at": "2024-01-26T14:03:28.878609Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.879240Z", "completed_at": "2024-01-26T14:03:28.879244Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005583286285400391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_id.2da437bec9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect listing_id\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere listing_id is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.881213Z", "completed_at": "2024-01-26T14:03:28.884500Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.885039Z", "completed_at": "2024-01-26T14:03:28.885042Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005042076110839844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_listings_cleansed_listing_name.ce2dfdb9ae", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect listing_name\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere listing_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.886794Z", "completed_at": "2024-01-26T14:03:28.889897Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.890420Z", "completed_at": "2024-01-26T14:03:28.890423Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0047760009765625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_listings_cleansed_price.b57b487821", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect price\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere price is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.892187Z", "completed_at": "2024-01-26T14:03:28.896177Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.896657Z", "completed_at": "2024-01-26T14:03:28.896660Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005524158477783203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_dim_listings_cleansed_updated_at.e76e5cb417", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere updated_at is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.898262Z", "completed_at": "2024-01-26T14:03:28.901594Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.902054Z", "completed_at": "2024-01-26T14:03:28.902057Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00481104850769043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.positive_value_dim_listings_cleansed_minimum_nights.78fa6fc313", "compiled": true, "compiled_code": "\n    SELECT\n        *\n    FROM\n        AIRBNB.DEV.dim_listings_cleansed\n    WHERE\n        minimum_nights < 1\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.903566Z", "completed_at": "2024-01-26T14:03:28.908259Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.908721Z", "completed_at": "2024-01-26T14:03:28.908724Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006145954132080078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.relationships_dim_listings_cleansed_host_id__host_id__ref_dim_hosts_cleansed_.b53b94b2ad", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select host_id as from_field\n    from AIRBNB.DEV.dim_listings_cleansed\n    where host_id is not null\n),\n\nparent as (\n    select host_id as to_field\n    from AIRBNB.DEV.dim_hosts_cleansed\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.910203Z", "completed_at": "2024-01-26T14:03:28.912756Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.913172Z", "completed_at": "2024-01-26T14:03:28.913174Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003901243209838867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.unique_dim_listings_cleansed_listing_id.930e4e859e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    listing_id as unique_field,\n    count(*) as n_records\n\nfrom AIRBNB.DEV.dim_listings_cleansed\nwhere listing_id is not null\ngroup by listing_id\nhaving count(*) > 1\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.914819Z", "completed_at": "2024-01-26T14:03:28.917130Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.917561Z", "completed_at": "2024-01-26T14:03:28.917565Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0038008689880371094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbtlearn.mart_fullmoon_reviews", "compiled": true, "compiled_code": "\n\nWITH fct_reviews AS (\n    SELECT * FROM AIRBNB.DEV.fct_reviews\n),\nfull_moon_dates AS (\n    SELECT * FROM AIRBNB.DEV.seed_full_moon_dates\n)\n\nSELECT\n    fct_reviews.*,\n    IFF(\n        full_moon_dates.full_moon_date IS NULL,\n        'not full moon',\n        'full moon'\n    ) AS is_full_moon\nFROM\n    fct_reviews\n    LEFT JOIN full_moon_dates\n        ON (\n            TO_DATE(fct_reviews.review_date)\n            = DATEADD(DAY, 1, full_moon_dates.full_moon_date)\n        )", "relation_name": "AIRBNB.DEV.mart_fullmoon_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.919188Z", "completed_at": "2024-01-26T14:03:28.922723Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.923151Z", "completed_at": "2024-01-26T14:03:28.923154Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004942178726196289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.accepted_values_fct_reviews_review_sentiment__positive__neutral__negative.7309aafcef", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        review_sentiment as value_field,\n        count(*) as n_records\n\n    from AIRBNB.DEV.fct_reviews\n    group by review_sentiment\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'positive','neutral','negative'\n)\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.924509Z", "completed_at": "2024-01-26T14:03:28.926444Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.926839Z", "completed_at": "2024-01-26T14:03:28.926841Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003178119659423828, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.consistent_create_at", "compiled": true, "compiled_code": "SELECT\n    *\nFROM\n    AIRBNB.DEV.dim_listings_cleansed listings\n    INNER JOIN AIRBNB.DEV.fct_reviews reviews USING (listing_id)\nWHERE\n    listings.created_at >= reviews.review_date", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.928209Z", "completed_at": "2024-01-26T14:03:28.930650Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.931035Z", "completed_at": "2024-01-26T14:03:28.931037Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.003721952438354492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_fct_reviews_review_date.d0bb4963d5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect review_date\nfrom AIRBNB.DEV.fct_reviews\nwhere review_date is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.932294Z", "completed_at": "2024-01-26T14:03:28.935644Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.936024Z", "completed_at": "2024-01-26T14:03:28.936027Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004540920257568359, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.not_null_fct_reviews_reviewer_name.8204e43c88", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect reviewer_name\nfrom AIRBNB.DEV.fct_reviews\nwhere reviewer_name is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.937384Z", "completed_at": "2024-01-26T14:03:28.940168Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.940562Z", "completed_at": "2024-01-26T14:03:28.940564Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004091024398803711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.relationships_fct_reviews_listing_id__listing_id__ref_dim_listings_cleansed_.7dd9ef05fe", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select listing_id as from_field\n    from AIRBNB.DEV.fct_reviews\n    where listing_id is not null\n),\n\nparent as (\n    select listing_id as to_field\n    from AIRBNB.DEV.dim_listings_cleansed\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.941801Z", "completed_at": "2024-01-26T14:03:28.946888Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.947285Z", "completed_at": "2024-01-26T14:03:28.947288Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006312847137451172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.dbt_expectations_expect_column_max_to_be_between_dim_listings_w_hosts_price__5000.5218138b75", "compiled": true, "compiled_code": "\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and max(price) <= 5000\n)\n as expression\n\n\n    from AIRBNB.DEV.dim_listings_w_hosts\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.948564Z", "completed_at": "2024-01-26T14:03:28.953473Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:28.953895Z", "completed_at": "2024-01-26T14:03:28.953897Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00617527961730957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.dbt_expectations_expect_column_quantile_values_to_be_between_dim_listings_w_hosts_price__500__50__0_99.71a0bfb970", "compiled": true, "compiled_code": "\n\n\n\n\n\n    with grouped_expression as (\n    select\n        \n        \n    \n  \n( 1=1 and percentile_cont(0.99) within group (order by price) >= 50 and percentile_cont(0.99) within group (order by price) <= 500\n)\n as expression\n\n\n    from AIRBNB.DEV.dim_listings_w_hosts\n    \n\n),\nvalidation_errors as (\n\n    select\n        *\n    from\n        grouped_expression\n    where\n        not(expression = true)\n\n)\n\nselect *\nfrom validation_errors\n\n\n\n\n\n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:28.955239Z", "completed_at": "2024-01-26T14:03:30.118310Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:30.119131Z", "completed_at": "2024-01-26T14:03:30.119138Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.3846781253814697, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.dbt_expectations_expect_column_values_to_be_of_type_dim_listings_w_hosts_price__number.6e17061c8a", "compiled": true, "compiled_code": "with relation_columns as (\n\n        \n        select\n            cast('LISTING_ID' as TEXT) as relation_column,\n            cast('NUMBER' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('HOST_ID' as TEXT) as relation_column,\n            cast('NUMBER' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('LISTING_NAME' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('ROOM_TYPE' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('MINIMUM_NIGHTS' as TEXT) as relation_column,\n            cast('NUMBER' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('PRICE' as TEXT) as relation_column,\n            cast('NUMBER' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('HOST_NAME' as TEXT) as relation_column,\n            cast('VARCHAR' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('HOST_IS_SUPERHOST' as TEXT) as relation_column,\n            cast('BOOLEAN' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('CREATED_AT' as TEXT) as relation_column,\n            cast('TIMESTAMP_NTZ' as TEXT) as relation_column_type\n        union all\n        \n        select\n            cast('UPDATED_AT' as TEXT) as relation_column,\n            cast('TIMESTAMP_NTZ' as TEXT) as relation_column_type\n        \n        \n    ),\n    test_data as (\n\n        select\n            *\n        from\n            relation_columns\n        where\n            relation_column = 'PRICE'\n            and\n            relation_column_type not in ('NUMBER')\n\n    )\n    select *\n    from test_data", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:31.343301Z", "completed_at": "2024-01-26T14:03:31.366206Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:31.366874Z", "completed_at": "2024-01-26T14:03:31.366879Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.02577805519104004, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbtlearn.dbt_expectations_expect_table_row_count_to_equal_other_table_dim_listings_w_hosts_source_airbnb_listings_.637b6229da", "compiled": true, "compiled_code": "\n    with a as (\n        \n    select\n        \n        count(*) as expression\n    from\n        AIRBNB.DEV.dim_listings_w_hosts\n    \n\n    ),\n    b as (\n        \n    select\n        \n        count(*) * 1 as expression\n    from\n        AIRBNB.raw.raw_listings\n    \n\n    ),\n    final as (\n\n        select\n            \n            a.expression,\n            b.expression as compare_expression,\n            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0)) as expression_difference,\n            abs(coalesce(a.expression, 0) - coalesce(b.expression, 0))/\n                nullif(a.expression * 1.0, 0) as expression_difference_percent\n        from\n        \n            a cross join b\n        \n    )\n    -- DEBUG:\n    -- select * from final\n    select\n        *\n    from final\n    where\n        \n        expression_difference > 0.0\n        \n", "relation_name": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-01-26T14:03:31.368938Z", "completed_at": "2024-01-26T14:03:31.371525Z"}, {"name": "execute", "started_at": "2024-01-26T14:03:31.372055Z", "completed_at": "2024-01-26T14:03:31.372058Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.004378795623779297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbtlearn.full_moon_no_sleep", "compiled": true, "compiled_code": "WITH mart_fullmoon_reviews AS (\n    SELECT * FROM AIRBNB.DEV.mart_fullmoon_reviews\n)\n\nSELECT\n    is_full_moon,\n    review_sentiment,\n    COUNT(*) as reviews\nFROM\n    mart_fullmoon_reviews\nGROUP BY\n    is_full_moon,\n    review_sentiment\nORDER BY\n    is_full_moon,\n    review_sentiment", "relation_name": null}], "elapsed_time": 5.953359127044678, "args": {"use_colors": true, "log_level_file": "debug", "show_resource_report": false, "introspect": true, "static": false, "strict_mode": false, "print": true, "enable_legacy_logger": false, "log_file_max_bytes": 10485760, "static_parser": true, "populate_cache": true, "empty_catalog": false, "partial_parse_file_diff": true, "select": [], "version_check": true, "log_path": "/Users/mariany.silva/Documents/projects/complete-dbt-bootcamp-zero-to-hero/dbtlearn/logs", "log_format_file": "debug", "project_dir": "/Users/mariany.silva/Documents/projects/complete-dbt-bootcamp-zero-to-hero/dbtlearn", "partial_parse": true, "which": "generate", "cache_selected_only": false, "printer_width": 80, "compile": true, "log_format": "default", "use_colors_file": true, "log_level": "info", "write_json": true, "favor_state": false, "vars": {}, "defer": false, "invocation_command": "dbt docs generate", "exclude": [], "warn_error_options": {"include": [], "exclude": []}, "macro_debugging": false, "indirect_selection": "eager", "profiles_dir": "/Users/mariany.silva/.dbt", "send_anonymous_usage_stats": true, "quiet": false}}